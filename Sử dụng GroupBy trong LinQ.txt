var wishlists = _dataContext.Wishlists
    .Include(x => x.Product)
    .Include(x => x.User)
    .GroupBy(x => new { x.UserId, x.ProductId })
    .Select(g => g.OrderBy(x => x.Id).First())  or .Select(g => g.First())
    .ToList();



Explain in Detail  :  


1ï¸âƒ£ _dataContext.Wishlists

ğŸ‘‰ Láº¥y báº£ng Wishlists trong database

2ï¸âƒ£ .Include(x => x.Product)

ğŸ‘‰ NÃ³i vá»›i EF:

â€œLáº¥y thÃªm thÃ´ng tin Product liÃªn quanâ€

â¡ï¸ Náº¿u khÃ´ng cÃ³ dÃ²ng nÃ y:

item.Product trong View sáº½ null

3ï¸âƒ£ .Include(x => x.User)

ğŸ‘‰ NÃ³i vá»›i EF:

â€œLáº¥y thÃªm thÃ´ng tin User liÃªn quanâ€


5ï¸âƒ£ .GroupBy(x => new { x.UserId, x.ProductId })

ğŸ‘‰ GOM NHÃ“M

Náº¿u UserId giá»‘ng nhau

VÃ€ ProductId giá»‘ng nhau
â¡ï¸ thÃ¬ gom láº¡i 1 nhÃ³m

ğŸ“¦ VÃ­ dá»¥:

(User A, Product 2017) â†’ 1 nhÃ³m
(User A, Product 2017) â†’ cÃ¹ng nhÃ³m

6ï¸âƒ£ .Select(g => g.OrderBy(x => x.Id).First())

ğŸ‘‰ CHá»ŒN 1 DÃ’NG Äáº I DIá»†N CHO Má»–I NHÃ“M

g = 1 nhÃ³m wishlist

OrderBy(x => x.Id):

sáº¯p xáº¿p theo Id tÄƒng dáº§n

First():

láº¥y dÃ²ng Ä‘áº§u tiÃªn

ğŸ“Œ NghÄ©a lÃ :

Náº¿u bá»‹ trÃ¹ng, giá»¯ dÃ²ng Ä‘Æ°á»£c thÃªm sá»›m nháº¥t

7ï¸âƒ£ .ToList()

ğŸ‘‰ Thá»±c thi query
ğŸ‘‰ Tráº£ vá» List<WishlistModel>

----------------------------------------------------------------------------------------------------------------------------------------------


PHÃ‚N TÃCH Tá»ªNG BÆ¯á»šC
1ï¸âƒ£ Include(...)

ğŸ‘‰ Load thÃªm:

ThÃ´ng tin Product

ThÃ´ng tin User

(chÆ°a lá»c gÃ¬ cáº£)

2ï¸âƒ£ GroupBy(x => new { x.UserId, x.ProductId })

ğŸ‘‰ Gom dá»¯ liá»‡u theo cáº·p (UserId, ProductId)

Káº¿t quáº£ nhÃ³m:

NhÃ³m	UserId	ProductId	CÃ¡c Id
1	A	1012	          [1]
2	B	2016	          [2]
3	A	1002	          [3]
4	C	2017	          [4, 5]
3ï¸âƒ£ Select(g => g.OrderBy(x => x.Id).First())

ğŸ‘‰ Má»—i nhÃ³m:

Sáº¯p xáº¿p theo Id tÄƒng dáº§n

Láº¥y dÃ²ng Ä‘áº§u tiÃªn

Káº¿t quáº£ sau Select:

Id	UserId	ProductId
1	A	1012
2	B	2016
3	A	1002
4	C	2017

â¡ï¸ Id = 5 bá»‹ loáº¡i bá» (vÃ¬ trÃ¹ng vá»›i Id = 4)

4ï¸âƒ£ .ToList()

ğŸ‘‰ Thá»±c thi query
ğŸ‘‰ Tráº£ vá» danh sÃ¡ch cuá»‘i cÃ¹ng

âœ… Káº¾T QUáº¢ CUá»I CÃ™NG wishlists
Id	UserId	ProductId
1	A	1012
2	B	2016
3	A	1002
4	C	2017

ğŸ¯ Má»—i cáº·p (UserId, ProductId) chá»‰ cÃ²n 1 dÃ²ng


